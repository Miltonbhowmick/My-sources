https://hermetic.ch/cfunlib/ast_amp2.htm
